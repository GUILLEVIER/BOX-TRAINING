<div class="main-container">
  <!-- Loading State -->
  @if (loading()) {
    <!-- Usar componente loading -->
     <app-loading
      [message]="'Cargando detalles del instructor...'"
     />
  }

  <!-- Instructor Details -->
  @if (!loading() && instructor()) {
  <!-- Page Header -->
  <app-page-header
    [title]="instructorFullName()"
    [showBackButton]="true"
    titleIcon="person"
    [actions]="headerActionsTemplate"
  >
  </app-page-header>

  <!-- Header Actions Template -->
  <ng-template #headerActionsTemplate>
    <button mat-raised-button color="primary" (click)="editInstructor()">
      <mat-icon>edit</mat-icon>
      Editar Instructor
    </button>
    <button
      mat-raised-button
      [color]="instructor()!.status === 'ACTIVE' ? 'warn' : 'primary'"
      (click)="toggleInstructorStatus()"
    >
      <mat-icon>{{ instructor()!.status === 'ACTIVE' ? 'pause' : 'play_arrow' }}</mat-icon>
      {{ instructor()!.status === 'ACTIVE' ? 'Desactivar' : 'Activar' }}
    </button>
  </ng-template>

  <!-- Instructor Information Cards -->
  <div>
    <!-- Basic Information Card -->
    <mat-card>
      <mat-card-header>
        <mat-card-title>
          <mat-icon>info</mat-icon>
          Información Personal
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        @if (instructor()!.photo) {
        <div>
          <img [src]="instructor()!.photo" [alt]="instructorFullName()" />
        </div>
        }
        <div>
          <div>
            <label>Nombre Completo:</label>
            <span>{{ instructorFullName() }}</span>
          </div>
          <div>
            <label>Email:</label>
            <span>{{ instructor()!.email }}</span>
          </div>
          <div>
            <label>Teléfono:</label>
            <span>{{ instructor()!.phone }}</span>
          </div>
          <div>
            <label>Estado:</label>
            <mat-chip [color]="getInstructorStatusChipColor(instructor()!.status)">
              {{ getInstructorStatusText(instructor()!.status) }}
            </mat-chip>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Specialties Card -->
    <mat-card>
      <mat-card-header>
        <mat-card-title>
          <mat-icon>fitness_center</mat-icon>
          Especialidades
        </mat-card-title>
        <mat-card-subtitle> Áreas de experticia del instructor </mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        @if (instructor()!.specialties && instructor()!.specialties.length > 0) {
        <div>
          @for (specialty of instructor()!.specialties; track specialty) {
          <mat-chip>
            {{ specialty }}
          </mat-chip>
          }
        </div>
        } @else {
        <p>No se han definido especialidades para este instructor.</p>
        }
      </mat-card-content>
    </mat-card>

    <!-- Biography Card -->
    @if (instructor()!.biography) {
    <mat-card>
      <mat-card-header>
        <mat-card-title>
          <mat-icon>description</mat-icon>
          Biografía
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <p>{{ instructor()!.biography }}</p>
      </mat-card-content>
    </mat-card>
    }

    <!-- Schedule Information Card - Placeholder for future functionality -->
    <mat-card>
      <mat-card-header>
        <mat-card-title>
          <mat-icon>schedule</mat-icon>
          Horarios Asignados
        </mat-card-title>
        <mat-card-subtitle> Clases programadas para este instructor </mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        <div>
          <mat-icon>event_note</mat-icon>
          <p>
            Los horarios y clases asignadas se mostrarán aquí cuando se implemente la gestión de
            horarios.
          </p>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Danger Zone -->
  <mat-card>
    <mat-card-header>
      <mat-card-title>
        <mat-icon color="warn">warning</mat-icon>
        Zona de Peligro
      </mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <p>Las siguientes acciones son irreversibles. Proceda con precaución.</p>
      <div>
        <button mat-raised-button color="warn" (click)="deleteInstructor()">
          <mat-icon>delete</mat-icon>
          Eliminar Instructor
        </button>
        <div>
          <mat-icon>info</mat-icon>
          <span
            >Asegúrese de que el instructor no tenga clases programadas antes de eliminarlo</span
          >
        </div>
      </div>
    </mat-card-content>
  </mat-card>
  }
</div>
